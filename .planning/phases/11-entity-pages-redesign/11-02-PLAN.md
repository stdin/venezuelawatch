---
phase: 11-entity-pages-redesign
plan: 02
type: execute
---

<objective>
Rebuild EntityLeaderboard component with Mantine Card, Badge, and Text components.

Purpose: Replace custom CSS list styling with Mantine's professional card-based UI, following Phase 10 EventList skeleton loading and badge patterns.
Output: EntityLeaderboard with Mantine Card for each entity item, Badge for entity type and rank, skeleton loading states, no custom CSS.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
./summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/11-entity-pages-redesign/11-01-SUMMARY.md
@.planning/phases/10-dashboard-redesign/10-02-SUMMARY.md
@.planning/phases/06-entity-watch/06-04-SUMMARY.md
@frontend/src/components/EntityLeaderboard.tsx
@frontend/src/components/EntityLeaderboard.css

**Tech stack available:**
- Mantine UI v8.3.11: Card, Badge, Text, Group, Stack, Skeleton
- @tanstack/react-virtual for virtualization

**Established patterns:**
- Phase 10: Mantine Card with padding="md" and withBorder
- Phase 10: Badge for color-coded categories (risk scores, severity)
- Phase 10: Skeleton loading pattern with 5 placeholder cards
- Phase 6: Entity type badge colors (Person=blue, Organization=purple, Government=red, Location=green)
- Phase 6: Virtualized leaderboard using @tanstack/react-virtual

**Constraining decisions:**
- Phase 9: Use Mantine components for all UI
- Phase 10: Skeleton loading with Card + Skeleton components
- Phase 6: Entity type badge color-coding pattern
- Phase 6: Virtualized list for performance

**From Phase 6 Summary:**
- Entity type colors: Person=blue, Org=purple, Gov=red, Location=green
- Rank badges with # prefix (circular gradient badges)
- Virtualized list with @tanstack/react-virtual
- 80px estimated row height
</context>

<tasks>

<task type="auto">
  <name>Task 1: Rebuild EntityLeaderboard with Mantine components</name>
  <files>frontend/src/components/EntityLeaderboard.tsx</files>
  <action>Rebuild EntityLeaderboard using Mantine components. Import Card, Badge, Text, Group, Stack, Skeleton from @mantine/core. Add loading prop to EntityLeaderboardProps interface (loading?: boolean). If loading is true, return Stack with 5 Skeleton cards (similar to EventList pattern from Phase 10-02): Stack gap="sm" containing 5 Card components, each Card has Stack gap="xs" with 3 Skeleton lines (height={20} width="80%", height={14} width="60%", height={14} width="40%"). For actual entity list rendering: preserve virtualization logic (@tanstack/react-virtual). For each entity card, use Mantine Card with padding="sm" withBorder and onClick={onSelect} style={{ cursor: 'pointer', backgroundColor: isSelected ? 'var(--mantine-color-blue-light)' : undefined }}. Inside Card, use Group justify="space-between": Left side has Group gap="xs" with rank Badge (size="lg" variant="filled" circle color="gray" containing rank number with # prefix), entity name Text (size="sm" fw={500}), entity type Badge (size="sm" with color based on type: PERSON=blue, ORGANIZATION=grape, GOVERNMENT=red, LOCATION=green). Right side has metric value Text (size="xs" c="dimmed" showing formatted metric value). Remove all custom CSS classes. Keep getEntityTypeBadge and formatMetricValue helper functions but adapt them to return Mantine Badge colors. Remove EntityLeaderboard.css import.</action>
  <verify>npm run dev starts, EntityLeaderboard shows skeleton cards during loading, then Mantine Card list items with badges, virtualization still works</verify>
  <done>EntityLeaderboard rebuilt with Mantine Card/Badge/Text/Group/Stack, skeleton loading states functional, entity type badges color-coded, rank badges visible, virtualization preserved, no custom CSS classes in component</done>
</task>

<task type="auto">
  <name>Task 2: Update Entities page to pass loading prop</name>
  <files>frontend/src/pages/Entities.tsx</files>
  <action>Update the EntityLeaderboard component usage in Entities.tsx to pass loading prop. Change from <EntityLeaderboard entities={entities} ... /> to <EntityLeaderboard entities={entities || []} selectedId={selectedEntityId} onSelect={setSelectedEntityId} loading={loading && entities.length === 0} />. This ensures skeleton loading shows during initial fetch but not during subsequent metric switches if we already have data. Remove custom loading-state, error-state, empty-state div elements from Entities.tsx - EntityLeaderboard now handles its own empty state with Mantine components.</action>
  <verify>Metric switching shows skeleton loading only on initial load, entity data appears in Mantine cards after load</verify>
  <done>Entities page passes loading prop to EntityLeaderboard, skeleton cards show during initial load, no custom loading/empty state divs in Entities.tsx</done>
</task>

<task type="auto">
  <name>Task 3: Delete EntityLeaderboard.css</name>
  <files>frontend/src/components/EntityLeaderboard.css</files>
  <action>Delete the EntityLeaderboard.css file completely. Remove the import './EntityLeaderboard.css' line from EntityLeaderboard.tsx. Mantine components provide all styling.</action>
  <verify>npm run dev starts, EntityLeaderboard renders with Mantine styling, no console errors about missing CSS</verify>
  <done>EntityLeaderboard.css deleted, import removed, Mantine components render properly</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] npm run dev starts without errors
- [ ] EntityLeaderboard shows skeleton cards during loading
- [ ] Entity items render as Mantine Cards with borders
- [ ] Rank badges show # prefix with gray background
- [ ] Entity type badges color-coded (blue/grape/red/green)
- [ ] Metric values displayed on right side
- [ ] Selected entity highlights with blue background
- [ ] Virtualization still works (smooth scrolling)
- [ ] EntityLeaderboard.css deleted
- [ ] No console errors
</verification>

<success_criteria>

- EntityLeaderboard rebuilt with Mantine components
- Skeleton loading states implemented
- Entity type badge color-coding preserved
- Rank badges with Mantine Badge
- Virtualization with @tanstack/react-virtual preserved
- EntityLeaderboard.css deleted
- No TypeScript errors
  </success_criteria>

<output>
After completion, create `.planning/phases/11-entity-pages-redesign/11-02-SUMMARY.md`:

# Phase 11 Plan 2: EntityLeaderboard Redesign Summary

**[Substantive one-liner - what shipped]**

## Accomplishments

- [Key outcomes]

## Files Created/Modified

- `frontend/src/components/EntityLeaderboard.tsx` - Description
- `frontend/src/pages/Entities.tsx` - Description
- `frontend/src/components/EntityLeaderboard.css` - Description

## Decisions Made

[Key decisions and rationale, or "None"]

## Issues Encountered

[Problems and resolutions, or "None"]

## Next Step

Ready for 11-03-PLAN.md (EntityProfile Redesign)
</output>
