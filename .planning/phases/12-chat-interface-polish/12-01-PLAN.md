---
phase: 12-chat-interface-polish
plan: 01
type: execute
---

<objective>
Upgrade EventPreviewCard and EntityPreviewCard tool UI components with Mantine components for visual consistency.

Purpose: Polish tool cards in chat interface with professional Mantine styling while maintaining compact chat-optimized layout.
Output: EventPreviewCard and EntityPreviewCard using Mantine Card/Badge/Text, matching Dashboard/Entity page visual language, custom CSS files deleted.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
./summary.md
~/.claude/get-shit-done/references/checkpoints.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/12-chat-interface-polish/12-CONTEXT.md
@.planning/phases/10-dashboard-redesign/10-02-SUMMARY.md
@.planning/phases/11-entity-pages-redesign/11-03-SUMMARY.md
@.planning/phases/07-ai-chat-interface/07-03-SUMMARY.md
@frontend/src/components/chat/EventPreviewCard.tsx
@frontend/src/components/chat/EntityPreviewCard.tsx

**Tech stack available:**
- Mantine UI v8.3.11: Card, Alert, Badge, Text, Title, Group, Stack, Divider
- date-fns for date formatting
- assistant-ui makeAssistantToolUI pattern

**Established patterns:**
- Phase 10: Mantine Badge colors for risk (red ≥75, orange 50-74, blue <50)
- Phase 10: Mantine Badge colors for severity (SEV1=red, SEV2=orange, SEV3=yellow, SEV4=blue, SEV5=gray)
- Phase 11: Mantine Alert color='red' variant='filled' for sanctions warnings
- Phase 11: Entity type Badge colors (blue=Person, grape=Org, red=Gov, green=Location)
- Phase 7: Expand-in-place pattern with useState, compact inline chat display

**Constraining decisions:**
- Phase 7: Keep compact chat-optimized sizing (not full Dashboard component sizes)
- Phase 7: Preserve expand-in-place interaction (not navigation)
- Phase 7: Tool cards render via makeAssistantToolUI pattern
- Phase 12 Context: Adaptive density (single items compact, lists more spacing)
- Phase 12 Context: Message rendering (ThreadPrimitive) stays unchanged
</context>

<tasks>

<task type="auto">
  <name>Task 1: Upgrade EventPreviewCard with Mantine components</name>
  <files>frontend/src/components/chat/EventPreviewCard.tsx</files>
  <action>Replace custom CSS with Mantine components. Import Card, Badge, Text, Group, Stack, Button from @mantine/core. For EventItem component: wrap in Card with size="sm" padding="xs" withBorder. Use Group for title/badges row. Use Badge for risk score with colors: red (score ≥75), orange (50-74), blue (<50). Use Badge for severity with colors: SEV1=red, SEV2=orange, SEV3=yellow, SEV4=blue, SEV5=gray. Use Text size="xs" c="dimmed" for metadata (date, source). Use Stack gap="xs" for vertical spacing. Keep expand/collapse logic with Button variant="subtle" size="xs". Use date-fns format() instead of custom formatDate. Remove all className= and custom CSS. For multiple events list, use Stack gap="xs" (adaptive density). Preserve makeAssistantToolUI wrapper and tool name='search_events'.</action>
  <verify>npm run dev starts, EventPreviewCard renders in chat with Mantine styling, expand/collapse works, badge colors match Dashboard</verify>
  <done>EventPreviewCard uses only Mantine components, no custom CSS classes, badge colors match Phase 10 patterns (red/orange/blue for risk, SEV colors for severity)</done>
</task>

<task type="auto">
  <name>Task 2: Upgrade EntityPreviewCard with Mantine components</name>
  <files>frontend/src/components/chat/EntityPreviewCard.tsx</files>
  <action>Replace custom CSS with Mantine components. Import Card, Alert, Badge, Text, Group, Stack, Button, Divider from @mantine/core. Use Card size="sm" padding="xs" withBorder for EntityProfileCard. If is_sanctioned=true, use Alert color="red" variant="filled" title="Sanctioned" with Text size="xs" "This entity appears on sanctions lists". Use Badge for entity type with colors from Phase 11: PERSON=blue, ORGANIZATION=grape, GOVERNMENT=red, LOCATION=green. Use Badge for risk score (same colors as EventPreviewCard). Use Text size="xs" for mention_count, dates. For recent_mentions, use Stack gap="xs" with Text size="xs" c="dimmed" for each mention. Use Divider to separate sections. Keep expand logic. Use date-fns format(). For TrendingEntitiesCard (same file), use Stack gap="xs" for entity list, Card size="sm" for each entity. Remove all custom CSS classes. Preserve makeAssistantToolUI wrappers for both tool names ('get_entity_profile', 'get_trending_entities').</action>
  <verify>npm run dev starts, EntityPreviewCard and TrendingEntitiesCard render with Mantine styling, sanctions Alert appears correctly, entity type badges match Entity page colors</verify>
  <done>EntityPreviewCard and TrendingEntitiesCard use only Mantine components, sanctions Alert matches Phase 11 pattern, entity badges match Phase 11 colors (blue/grape/red/green)</done>
</task>

<task type="auto">
  <name>Task 3: Delete custom CSS files</name>
  <files>frontend/src/components/chat/EventPreviewCard.css, frontend/src/components/chat/EntityPreviewCard.css</files>
  <action>Delete EventPreviewCard.css and EntityPreviewCard.css completely. Remove import './EventPreviewCard.css' from EventPreviewCard.tsx. Remove import './EntityPreviewCard.css' from EntityPreviewCard.tsx. Mantine components provide all styling.</action>
  <verify>npm run dev starts, tool cards render with Mantine styling, no console errors about missing CSS</verify>
  <done>CSS files deleted, imports removed, tool cards render using only Mantine component styling</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] npm run dev starts without errors
- [ ] EventPreviewCard uses Mantine Card/Badge/Text, no custom CSS
- [ ] EntityPreviewCard uses Mantine Card/Badge/Text/Alert, no custom CSS
- [ ] Badge colors match Dashboard (risk: red/orange/blue, severity: SEV colors, entity type: blue/grape/red/green)
- [ ] Sanctions Alert matches Entity page style (red filled)
- [ ] Expand/collapse functionality preserved
- [ ] Tool cards display correctly in chat
- [ ] No TypeScript errors
</verification>

<success_criteria>

- EventPreviewCard and EntityPreviewCard upgraded with Mantine components
- Custom CSS files deleted (EventPreviewCard.css, EntityPreviewCard.css)
- Badge colors consistent with Dashboard/Entity pages
- Compact chat-optimized sizing maintained
- Expand-in-place interaction preserved
- No TypeScript errors
  </success_criteria>

<output>
After completion, create `.planning/phases/12-chat-interface-polish/12-01-SUMMARY.md`:

# Phase 12 Plan 1: Event & Entity Tool Cards Summary

**[Substantive one-liner - what shipped]**

## Accomplishments

- EventPreviewCard upgraded with Mantine Card/Badge/Text components
- EntityPreviewCard and TrendingEntitiesCard upgraded with Mantine components
- Sanctions Alert using Mantine Alert (red filled variant)
- Badge colors match Dashboard/Entity page visual language
- Custom CSS files deleted (EventPreviewCard.css, EntityPreviewCard.css)
- Compact chat-optimized layout preserved

## Files Created/Modified

- `frontend/src/components/chat/EventPreviewCard.tsx` - Rebuilt with Mantine, removed custom CSS
- `frontend/src/components/chat/EntityPreviewCard.tsx` - Rebuilt with Mantine, removed custom CSS, added Mantine Alert for sanctions
- `frontend/src/components/chat/EventPreviewCard.css` - Deleted
- `frontend/src/components/chat/EntityPreviewCard.css` - Deleted

## Decisions Made

**Adaptive density:** EventItem cards use size="sm" padding="xs" for compactness. Multi-event lists use Stack gap="xs" for scannability.

**Badge color consistency:** Matched exact colors from Phase 10/11 (risk scores, severity levels, entity types) for visual cohesion across app.

## Issues Encountered

[Problems and resolutions, or "None"]

## Next Step

Ready for 12-02-PLAN.md (RiskTrendsChart upgrade)
</output>
