---
phase: 12-chat-interface-polish
plan: 02
type: execute
---

<objective>
Upgrade RiskTrendsChart tool UI component with Mantine components and verify complete phase.

Purpose: Complete chat interface polish by upgrading final tool card with Mantine styling, ensuring all 4 tool cards match Dashboard visual language.
Output: RiskTrendsChart using Mantine Card/Text, custom CSS deleted, Phase 12 complete with all tool cards professionally styled.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
./summary.md
~/.claude/get-shit-done/references/checkpoints.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/12-chat-interface-polish/12-CONTEXT.md
@.planning/phases/12-chat-interface-polish/12-01-SUMMARY.md
@.planning/phases/10-dashboard-redesign/10-03-SUMMARY.md
@frontend/src/components/chat/RiskTrendsChart.tsx

**Tech stack available:**
- Mantine UI v8.3.11: Card, Text, Title, Group, Stack
- Recharts ResponsiveContainer, LineChart, Line, XAxis, YAxis, CartesianGrid, Tooltip
- date-fns for date formatting
- Design tokens: var(--color-risk-high), var(--mantine-color-blue-filled)

**Established patterns:**
- Phase 10: Recharts ResponsiveContainer with width="100%" height={300}
- Phase 10: Mantine Card wrapper for charts with padding="md" withBorder
- Phase 10: Design token colors in charts for theme consistency
- Phase 10: Title order={4} for chart headers
- Phase 7: Compact inline display for chat context

**Constraining decisions:**
- Phase 7: Keep compact chart sizing (not full Dashboard size)
- Phase 7: Tool cards render via makeAssistantToolUI pattern
- Phase 10: Use design token colors for chart lines (var(--color-risk-high), etc.)
- Phase 12 Context: Maintain chat-optimized compactness
</context>

<tasks>

<task type="auto">
  <name>Task 1: Upgrade RiskTrendsChart with Mantine components</name>
  <files>frontend/src/components/chat/RiskTrendsChart.tsx</files>
  <action>Replace custom CSS with Mantine components. Import Card, Text, Title, Group, Stack from @mantine/core. Wrap entire component in Card with size="sm" padding="md" withBorder (slightly more padding than other cards for chart breathing room). Use Title order={4} for chart title "Risk Trends Over Time". Use Group justify="space-between" for title row if needed. For Recharts: keep ResponsiveContainer with width="100%" but reduce height to 200 (more compact for chat than Dashboard's 300). Keep Line components with stroke using design tokens: stroke="var(--color-risk-high)" for risk trend line. Use Text size="sm" c="dimmed" for any metadata or empty states. Remove all className= and custom CSS. Preserve makeAssistantToolUI wrapper with tool name='analyze_risk_trends'. If no data, show Card with Text c="dimmed" ta="center" "No risk trend data available".</action>
  <verify>npm run dev starts, RiskTrendsChart renders in chat with Mantine Card wrapper, chart displays correctly, uses design token colors</verify>
  <done>RiskTrendsChart uses Mantine Card/Title/Text, chart height reduced to 200 for compactness, design token colors preserved, no custom CSS classes</done>
</task>

<task type="auto">
  <name>Task 2: Delete RiskTrendsChart.css</name>
  <files>frontend/src/components/chat/RiskTrendsChart.css</files>
  <action>Delete RiskTrendsChart.css completely. Remove import './RiskTrendsChart.css' from RiskTrendsChart.tsx. Mantine components and inline Recharts styles provide all styling.</action>
  <verify>npm run dev starts, RiskTrendsChart renders with Mantine styling and chart displays correctly, no console errors</verify>
  <done>RiskTrendsChart.css deleted, import removed, chart renders using Mantine + Recharts styling</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>All 4 chat tool cards upgraded with Mantine components - EventPreviewCard, EntityPreviewCard, TrendingEntitiesCard, RiskTrendsChart</what-built>
  <how-to-verify>
    1. Run: cd frontend && npm run dev
    2. Visit: http://localhost:5173/chat
    3. Test search_events tool: Ask "Show me recent high-risk events"
       - Verify EventPreviewCard uses Mantine Card/Badge
       - Check risk score badges: red (≥75), orange (50-74), blue (<50)
       - Check severity badges: SEV1=red, SEV2=orange, SEV3=yellow, SEV4=blue, SEV5=gray
       - Test expand/collapse button works
    4. Test get_entity_profile tool: Ask "Tell me about Nicolás Maduro"
       - Verify EntityPreviewCard uses Mantine Card/Badge/Alert
       - If sanctioned, check red filled Alert appears
       - Check entity type badge: blue=Person, grape=Org, red=Gov, green=Location
    5. Test get_trending_entities tool: Ask "Show trending entities"
       - Verify TrendingEntitiesCard uses Mantine Card/Badge
       - Check entity type badges use same colors
    6. Test analyze_risk_trends tool: Ask "Show risk trends this week"
       - Verify RiskTrendsChart uses Mantine Card wrapper
       - Check chart renders correctly with design token colors
       - Chart should be more compact than Dashboard version
    7. Compare with Dashboard/Entity pages:
       - Badge colors should match exactly
       - Tool cards should feel cohesive but more compact
    8. Check console: No errors or missing CSS warnings
  </how-to-verify>
  <resume-signal>Type "approved" when all tool cards look professionally styled and match Dashboard visual language, or describe issues to fix</resume-signal>
</task>

</tasks>

<verification>
Before declaring phase complete:
- [ ] npm run dev starts without errors
- [ ] RiskTrendsChart uses Mantine Card/Title/Text, no custom CSS
- [ ] All 4 tool cards use Mantine components consistently
- [ ] Badge colors match Dashboard/Entity pages across all tools
- [ ] Tool cards maintain compact chat-optimized sizing
- [ ] Expand/collapse interactions work
- [ ] Human verification checkpoint passed
- [ ] No TypeScript errors
- [ ] No console errors or warnings
</verification>

<success_criteria>

- RiskTrendsChart upgraded with Mantine components
- RiskTrendsChart.css deleted
- All 4 tool cards professionally styled with Mantine
- Visual consistency with Dashboard/Entity pages achieved
- Compact chat-optimized layout maintained
- Human verification confirms UX quality
- **Phase 12 complete:** Chat interface polish finished
- No TypeScript errors
  </success_criteria>

<output>
After completion, create `.planning/phases/12-chat-interface-polish/12-02-SUMMARY.md`:

# Phase 12 Plan 2: RiskTrendsChart & Phase Complete Summary

**[Substantive one-liner - what shipped]**

## Accomplishments

- RiskTrendsChart upgraded with Mantine Card/Title/Text components
- Chart height reduced to 200 for chat compactness (vs 300 on Dashboard)
- RiskTrendsChart.css deleted
- **Phase 12 complete:** All 4 tool cards upgraded with Mantine components
- Visual consistency achieved across chat tool cards and Dashboard/Entity pages
- Professional polish maintained with compact chat-optimized sizing

## Files Created/Modified

- `frontend/src/components/chat/RiskTrendsChart.tsx` - Rebuilt with Mantine, reduced chart height, removed custom CSS
- `frontend/src/components/chat/RiskTrendsChart.css` - Deleted

## Decisions Made

**Chart sizing:** Reduced height to 200px (from Dashboard's 300px) for compact inline chat display while maintaining readability.

**Design token colors:** Preserved var(--color-risk-high) and other design tokens for chart lines, ensuring theme consistency.

## Issues Encountered

[Problems and resolutions, or "None"]

## Next Phase Readiness

**Phase 12 Complete** - Chat interface successfully polished with professional Mantine components. All 4 tool cards (EventPreviewCard, EntityPreviewCard, TrendingEntitiesCard, RiskTrendsChart) now match Dashboard/Entity page visual language while maintaining compact chat-optimized layouts. Total custom CSS removed: 3 files deleted.

Ready for: **Phase 13 - Responsive & Accessibility**
</output>
