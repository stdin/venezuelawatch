---
phase: 13-responsive-accessibility
plan: 03
type: execute
---

<objective>
Make Entities and Chat pages mobile-responsive and fully keyboard accessible.

Purpose: Ensure Entities and Chat pages work on mobile devices, with keyboard navigation and proper ARIA labels matching Dashboard standards.
Output: Both pages responsive across breakpoints, keyboard accessible, ARIA compliant, verified working on mobile.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
./summary.md
~/.claude/get-shit-done/references/checkpoints.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/13-responsive-accessibility/13-RESEARCH.md
@.planning/phases/13-responsive-accessibility/13-01-SUMMARY.md
@.planning/phases/13-responsive-accessibility/13-02-SUMMARY.md
@frontend/src/pages/Entities.tsx
@frontend/src/pages/Chat.tsx
@frontend/src/pages/Chat.css
@frontend/src/components/EntityLeaderboard.tsx
@frontend/src/components/EntityProfile.tsx

**Tech stack available:**
- Mantine Grid with responsive breakpoints
- useMediaQuery hook for mobile detection
- assistant-ui/react for chat interface
- Custom breakpoints: xs: 576px, sm: 768px, md: 992px, lg: 1200px, xl: 1408px

**Established patterns:**
- Phase 11: Entities page with 40/60 split-view (span={{ base: 12, md: 5 }} and span={{ base: 12, md: 7 }})
- Phase 11: SegmentedControl for metric toggles
- Phase 11: Virtualized leaderboard with @tanstack/react-virtual
- Phase 12: Chat with Perplexity-style center-focused layout (max-width: 44rem)
- Phase 12: Chat tool cards with Mantine components

**Constraining decisions:**
- Phase 6: Entity split-view should collapse to single column on mobile
- Phase 7: Chat center-focused, no sidebar (simpler mobile experience)
- Phase 12: Chat tool cards already use Mantine (should be responsive by default)
- WCAG 2.1 AA: Keyboard accessible, 44px touch targets, ARIA labels

**Research findings:**
- Split-view: Stack vertically on mobile (leaderboard first, then profile)
- Chat: Already center-focused, mainly needs keyboard nav for input/messages
- Touch targets: SegmentedControl buttons should be larger on mobile
- Keyboard: Arrow keys for leaderboard navigation, Tab for chat composer
</context>

<tasks>

<task type="auto">
  <name>Task 1: Make Entities page mobile-responsive</name>
  <files>frontend/src/pages/Entities.tsx, frontend/src/components/EntityLeaderboard.tsx, frontend/src/components/EntityProfile.tsx</files>
  <action>In Entities.tsx, verify Grid.Col spans for split-view: leaderboard span={{ base: 12, md: 5 }}, profile span={{ base: 12, md: 7 }}. On mobile, both columns stack vertically (leaderboard first, then profile when entity selected). Use useMediaQuery to detect mobile (<48em) and show profile in a separate view/modal on mobile (not side-by-side). In EntityLeaderboard, ensure SegmentedControl buttons meet 44x44px touch target on mobile - add size="md" or size="lg" with responsive sizing. Verify virtualized list scrolls properly on mobile with touch gestures. In EntityProfile, ensure Cards stack vertically with proper spacing on mobile using Mantine Stack with responsive gap={{ base: 'sm', md: 'md' }}. Test at 320px width for proper wrapping.</action>
  <verify>Open http://localhost:5173/entities at 320px, leaderboard visible, select entity shows profile (either below or in modal), no horizontal scroll, SegmentedControl buttons touchable, virtualized list scrolls smoothly</verify>
  <done>Entities page fully responsive 320px-1440px+, split-view stacks on mobile, touch targets meet 44px minimum, virtualized list works on mobile</done>
</task>

<task type="auto">
  <name>Task 2: Make Chat page mobile-responsive</name>
  <files>frontend/src/pages/Chat.tsx, frontend/src/pages/Chat.css</files>
  <action>In Chat.tsx, verify max-width: 44rem container is responsive (should use percentage padding on mobile). Update Chat.css to ensure .chat-container uses responsive padding: padding: clamp(0.5rem, 2vw, 2rem). Verify suggestion chips wrap on narrow screens (use CSS flexbox wrap or Mantine Group with wrap). Ensure .chat-composer-input has mobile-friendly sizing: min-height: 44px for touch target, font-size: 16px to prevent iOS zoom-in. For tool cards (EventPreviewCard, EntityPreviewCard, RiskTrendsChart), verify Mantine Card components are responsive with fluid width. Test message bubbles wrap properly on 320px width. Verify chat viewport scrolls smoothly on mobile with touch gestures. If .chat-welcome has fixed positioning, make it responsive.</action>
  <verify>Open http://localhost:5173/chat at 320px, suggestion chips wrap, composer input at least 44px height, tool cards display properly, messages wrap without horizontal scroll, smooth touch scrolling</verify>
  <done>Chat page fully responsive 320px-1440px+, composer meets touch target size, tool cards responsive, messages wrap properly, smooth mobile UX</done>
</task>

<task type="auto">
  <name>Task 3: Add keyboard navigation and ARIA labels</name>
  <files>frontend/src/pages/Entities.tsx, frontend/src/pages/Chat.tsx, frontend/src/components/EntityLeaderboard.tsx</files>
  <action>In EntityLeaderboard, ensure entity items are keyboard accessible: if using onClick on divs, add role="button" tabIndex={0} and onKeyDown for Enter/Space. Verify Arrow key navigation: add onKeyDown handler to move focus through list (ArrowDown to next item, ArrowUp to previous). Add aria-label="Entity leaderboard" to container, aria-label="[Metric] ranking" to list. In Entities page, add aria-label="Entity filters" to SegmentedControl, aria-label="Entity profile" to profile section. In Chat.tsx, verify ComposerPrimitive.Input has aria-label="Chat message input". Add aria-label="Conversation thread" to ThreadPrimitive.Viewport. Verify suggestion chips are keyboard accessible (Tab to focus, Enter to activate). Add aria-live="polite" to chat message area for screen reader announcements of new messages. Test Tab order: filters → leaderboard → profile for Entities; composer → send button for Chat.</action>
  <verify>Tab through Entities page reaches all interactive elements, Arrow keys navigate leaderboard, Enter selects entities; Tab through Chat reaches composer and send button, Enter sends message; Storybook a11y shows no violations</verify>
  <done>Both pages fully keyboard accessible, logical tab order, Arrow key navigation in leaderboard, ARIA labels for screen readers, Storybook a11y checks passing</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Entities and Chat pages responsive and keyboard accessible</what-built>
  <how-to-verify>
    1. Run: cd frontend && npm run dev
    2. Visit: http://localhost:5173/entities
    3. Entities responsive testing:
       - Resize to 320px - verify leaderboard visible, profile stacks or shows in modal
       - Resize to 768px - verify split-view works
       - Resize to 1024px+ - verify 40/60 split-view
       - Test SegmentedControl buttons are touchable (at least 44x44px)
       - Test virtualized list scrolls smoothly on mobile
    4. Entities keyboard testing:
       - Tab to metric toggles - verify focus visible
       - Tab to leaderboard - verify entities focusable
       - Arrow Down/Up - verify navigation through list
       - Enter on entity - verify profile loads
       - No keyboard traps
    5. Visit: http://localhost:5173/chat
    6. Chat responsive testing:
       - Resize to 320px - verify messages wrap, no horizontal scroll
       - Verify composer input at least 44px height
       - Verify suggestion chips wrap on narrow screens
       - Test tool cards display properly on mobile
       - Smooth touch scrolling
    7. Chat keyboard testing:
       - Tab to composer input - verify focus visible
       - Type message and press Enter - verify sends
       - Tab to send button - verify focusable
       - Suggestion chips keyboard accessible
    8. Storybook a11y:
       - Run: npm run storybook
       - Check Entities and Chat stories
       - Verify no a11y violations
    9. Optional screen reader testing:
       - VoiceOver or NVDA test on both pages
       - Verify ARIA labels announced
       - Verify new messages announced in Chat
  </how-to-verify>
  <resume-signal>Type "approved" when both pages are responsive and accessible, or describe issues to fix</resume-signal>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] Entities page responsive from 320px to 1440px+
- [ ] Split-view stacks on mobile (leaderboard → profile)
- [ ] SegmentedControl buttons meet 44x44px touch target
- [ ] Virtualized list scrolls on mobile
- [ ] Arrow key navigation in leaderboard
- [ ] Chat page responsive from 320px to 1440px+
- [ ] Chat composer meets 44px height minimum
- [ ] Tool cards display properly on mobile
- [ ] Messages wrap without horizontal scroll
- [ ] Keyboard navigation works on both pages
- [ ] ARIA labels added to all interactive regions
- [ ] Storybook a11y shows no violations
- [ ] Human verification checkpoint passed
- [ ] No TypeScript errors
</verification>

<success_criteria>

- Entities and Chat pages fully responsive (320px-1440px+)
- Keyboard navigation implemented with logical tab order
- Arrow key navigation in entity leaderboard
- ARIA labels provide context for screen readers
- Touch targets meet WCAG 2.1 AA requirements (44x44px)
- Virtualized list works on mobile
- Chat tool cards responsive
- Storybook a11y checks pass
- Human verification confirms UX quality
- No TypeScript errors or console warnings
  </success_criteria>

<output>
After completion, create `.planning/phases/13-responsive-accessibility/13-03-SUMMARY.md`:

# Phase 13 Plan 3: Entities & Chat Responsive Summary

**[Substantive one-liner - what shipped]**

## Accomplishments

- Entities page responsive with mobile-optimized split-view (stack vertically on mobile)
- Chat page responsive with fluid message layout
- Arrow key navigation in entity leaderboard
- ARIA labels added to both pages
- Touch targets verified (SegmentedControl, chat composer, buttons)
- Keyboard navigation working on both pages

## Files Created/Modified

- `frontend/src/pages/Entities.tsx` - Added responsive logic and ARIA labels
- `frontend/src/pages/Chat.tsx` - Enhanced mobile responsiveness and keyboard nav
- `frontend/src/pages/Chat.css` - Updated for mobile breakpoints
- `frontend/src/components/EntityLeaderboard.tsx` - Added keyboard navigation and ARIA
- `frontend/src/components/EntityProfile.tsx` - Responsive card stacking

## Decisions Made

**Entities mobile layout:** [Stacked view with profile below / Modal for profile / etc. - to be determined during implementation]

**Chat composer height:** Set to 44px minimum to meet touch target requirements and prevent iOS zoom-in with 16px font size.

## Issues Encountered

[Problems and resolutions, or "None"]

## Next Step

Ready for 13-04-PLAN.md (Accessibility Verification & Documentation)
</output>
