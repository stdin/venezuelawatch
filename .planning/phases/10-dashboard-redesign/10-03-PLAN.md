---
phase: 10-dashboard-redesign
plan: 03
type: execute
---

<objective>
Rebuild TrendsPanel with Recharts data visualization components.

Purpose: Replace custom CSS charts with production-ready Recharts library for professional data visualization. Implement risk trend line chart and event timeline bar chart.
Output: TrendsPanel component with Recharts-based visualizations showing risk score trends over time and event distribution by type.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
./summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/10-dashboard-redesign/10-RESEARCH.md
@.planning/phases/10-dashboard-redesign/10-02-SUMMARY.md
@.planning/phases/09-component-library/09-02-SUMMARY.md
@frontend/src/components/TrendsPanel.tsx
@frontend/src/components/TrendsPanel.css

**Tech stack available:**
- Recharts 3.6.0 (already installed): ResponsiveContainer, LineChart, BarChart, Line, Bar, XAxis, YAxis, CartesianGrid, Tooltip, Legend
- Mantine UI: Card, Text, Stack, Title
- date-fns for date formatting (installed in 10-01)

**Established patterns:**
- Phase 5: TrendsPanel shows risk trends and event metrics
- Phase 4: Risk scores 0-100 scale
- Phase 8: Design tokens for colors (--color-risk-high, --color-risk-medium, --color-risk-low)

**Constraining decisions:**
- Phase 9: Mantine components for all UI containers
- Phase 8: Use CSS custom property colors for charts
- Phase 4: Risk score thresholds: >70 high, 50-70 medium, <50 low

**From RESEARCH.md:**
- Pattern 2: Real-time chart updates with Recharts
- Use ResponsiveContainer with width="100%" height={300}
- LineChart for time-series risk trends
- BarChart for event type distribution
- Don't hand-roll chart components (use Recharts)
- Recharts handles animation, responsiveness, tooltips automatically
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create RiskTrendChart component</name>
  <files>frontend/src/components/charts/RiskTrendChart.tsx</files>
  <action>Create new RiskTrendChart component using Recharts LineChart. Import ResponsiveContainer, LineChart, Line, XAxis, YAxis, CartesianGrid, Tooltip, Legend from 'recharts'. Import format from 'date-fns' for date formatting. Component accepts props: data (array of {date: string, riskScore: number}). Use ResponsiveContainer with width="100%" height={300}. Use LineChart with data prop. Add XAxis with dataKey="date" and tickFormatter using format(new Date(value), 'MM/dd'). Add YAxis with domain={[0, 100]} and label="Risk Score". Add CartesianGrid with strokeDasharray="3 3". Add Tooltip with formatter showing date and score. Add Line with type="monotone" dataKey="riskScore" stroke="var(--color-risk-high)" strokeWidth={2} dot={false}. Export as default. This follows the research Pattern 2 example code exactly.</action>
  <verify>TypeScript compiles without errors, component exports successfully</verify>
  <done>RiskTrendChart component created with Recharts LineChart, uses design token colors, responsive, no TypeScript errors</done>
</task>

<task type="auto">
  <name>Task 2: Rebuild TrendsPanel with Recharts charts</name>
  <files>frontend/src/components/TrendsPanel.tsx</files>
  <action>Rebuild TrendsPanel to use Recharts and Mantine components. Import Card, Text, Stack, Title from @mantine/core. Import RiskTrendChart from './charts/RiskTrendChart'. Remove custom CSS visualization logic and TrendsPanel.css import. Transform events prop data into chart data: (1) Risk trend data: group events by date (using date-fns format), calculate average risk score per day, create array of {date, riskScore} for last 30 days. (2) Event type data: count events by event_type, create array of {type, count} for BarChart. Render two Card components in Stack: First card shows <Title order={4}>Risk Trend (30 Days)</Title> and <RiskTrendChart data={riskTrendData} />. Second card shows event type distribution as simple counts (chart implementation can be added later - focus on risk trend first). Use Mantine Card padding="md" and withBorder. Remove all custom CSS classes and TrendsPanel.css.</action>
  <verify>npm run dev starts, TrendsPanel shows risk trend line chart with Recharts, chart is responsive and has tooltips</verify>
  <done>TrendsPanel rebuilt with Mantine Cards and RiskTrendChart, shows 30-day risk trend, responsive chart, no custom CSS, data transforms correctly from events</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] npm run dev starts without errors
- [ ] TrendsPanel renders on Dashboard right panel
- [ ] Risk trend line chart visible with Recharts
- [ ] Chart shows last 30 days of risk data
- [ ] Chart is responsive (resizes with browser window)
- [ ] Tooltips show date and risk score on hover
- [ ] Y-axis shows 0-100 scale
- [ ] Chart uses design token colors
- [ ] No console errors
- [ ] No custom CSS imports
</verification>

<success_criteria>

- RiskTrendChart component created with Recharts
- TrendsPanel rebuilt with Mantine components
- Risk trend visualization working with real data
- Chart responsive and interactive (tooltips)
- Custom CSS removed (TrendsPanel.css)
- Data transformation logic correct (events â†’ chart data)
- No TypeScript errors
  </success_criteria>

<output>
After completion, create `.planning/phases/10-dashboard-redesign/10-03-SUMMARY.md`:

# Phase 10 Plan 3: Data Visualization with Recharts Summary

**[Substantive one-liner - what shipped]**

## Accomplishments

- [Key outcomes]

## Files Created/Modified

- `frontend/src/components/charts/RiskTrendChart.tsx` - Description
- `frontend/src/components/TrendsPanel.tsx` - Description

## Decisions Made

[Key decisions and rationale, or "None"]

## Issues Encountered

[Problems and resolutions, or "None"]

## Next Step

Ready for 10-04-PLAN.md (Filter UX Enhancement)
</output>
